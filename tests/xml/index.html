<html>
  <head>
    <meta http-equiv="content-type" content="text/html; charset=UTF-8">
    <link type="intl/l20n" href="./index.lol"/>
    <script type="text/javascript" src="../../lib/when.js"></script>
    <script type="text/javascript" src="../../lib/io.js"></script>
    <script type="text/javascript" src="../../lib/l20n.js"></script>
    <script type="text/javascript" src="../../lib/events.js"></script>
    <script type="text/javascript" src="../../lib/parser.js"></script>
    <script type="text/javascript" src="../../lib/compiler.js"></script>
    <script type="text/javascript">
var ids = [
  'settings',
  'networkAndConnectivity',
  'airplaneMode',
  'gps',
  'fullStatus_disconnected',
  'cellularAndData',
  'bluetooth',
  'internetSharing',
  'sound',
  'display',
  'notifications',
  'dateAndTime',
  'keyboard',
  'language',
  'accounts',
  'persona',
  'mail',
  'privacyAndSecurity',
  'phoneLock',
  'simSecurity',
  'appPermissions',
  'doNotTrack',
  'device',
  'deviceInfo',
  'battery',
  'deviceStorage',
  'mediaStorage',
  'accessibility',
  'improveBrowserOS',
  'help',
  'simToolkit',
  ];
var values = [];

var start = performance.now();
var counter = 0;
var r = 1;
L20n.Compiler = new Compiler(L20n.EventEmitter, L20n.Parser);

function localize() {
  var ctx = L20n.getContext();
  ctx.settings.locales = ['pl', 'en-US'];
  //ctx.settings.schemes = ['{{resource}}.{{locale}}.lol'];
  //ctx.addResource('l10n:settings:settings');
  ctx.addResource('l10n:./settings.{{locale}}.lol');
  //ctx.injectResource(null, "<one 'Jeden'>");
  ctx.addEventListener('error', function(e) {
    console.log('error');
    console.log(e);
  });
  ctx.addEventListener('ready', function() {
      counter++;
      try {
      console.log(ctx.get('settings'));
      } catch (e) {
        console.log(e);
      }
      //document.getElementById('one').innerHTML = ctx.get("one");
      //for (var i in ids) {
      //  values.push(ctx.get(ids[i]));
      //}
      //if (counter >= r && values.length == r*ids.length) {
      //  var end = performance.now();
      //  document.getElementById('time').innerHTML = end - start; 
      //}
      });
  ctx.freeze();
}

for (var j=0;j<r;j++) {
  localize(j);
}
    </script>
  </head>
  <body id="body">
    <button onclick="localize()">Start</button>
    <p data-l10n-id="one" id="one"></p>
    <p data-l10n-id="two"></p>
    <p id="time"></p>
  </body>
</html>
